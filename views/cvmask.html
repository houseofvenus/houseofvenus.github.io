<!DOCTYPE html>
<html>
<head>
    <title>CV Mask Experience | v. 0.6.0</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="./css/cv-mask.css" type="text/css" />
    <script src="./js/aframe100.js"></script><!--https://aframe.io/releases/1.0.0/-->
    <script src="https://rawgit.com/mayognaise/aframe-gif-shader/master/dist/aframe-gif-shader.min.js"></script>
    <script src="./js/aframe-ar.js"></script><!-- https://raw.githack.com/jeromeetienne/AR.js/2.2.0/aframe/build/-->
    <script>
        var maskInFocus = 0;
        var masks = [
            "smile-texture",
            "frown-texture",
            "inquisitive-texture",
            "exclamation-texture",
            "exclamation-secondary-texture",
            "bantu-mask-texture",
            "rainbow-belch-texture"
        ];
        var maskFeatureVisible = true;
        var audioFeatureVisible = true;
        
        function toggleMaskFeatureVisibility(){
            if(maskFeatureVisible){
                document.getElementById("mask-view-selector-container").style.opacity = 0;
                document.getElementById(`mask-view-${maskInFocus}`).setAttribute("visible", false);
                setTimeout(function(){
                    document.getElementById("mask-view-selector-container").style.display = "none";
                }, 500);
                
                maskFeatureVisible = false;
            }
            else{
                document.getElementById("mask-view-selector-container").style.display = "block";
                
                setTimeout(function(){
                    document.getElementById("mask-view-selector-container").style.opacity = 1.0;
                }, 50);
                
                document.getElementById(`mask-view-${maskInFocus}`).setAttribute("visible", true);
                
                maskFeatureVisible = true;
            }
        }
        
        function toggleAudioFeatureVisibility(){
            if(audioFeatureVisible){
                if(!document.getElementById("audio-feature-container").paused){
                    document.getElementById("audio-feature-container").pause();
                }
                document.getElementById("audio-feature-container").style.opacity = 0;
                
                setTimeout(function(){
                    document.getElementById("audio-feature-container").style.display = "none";
                }, 500);
                
                audioFeatureVisible = false;
            }
            else{
                document.getElementById("audio-feature-container").style.display = "block";
                setTimeout(function(){
                    document.getElementById("audio-feature-container").style.opacity = 1.0;
                }, 50);
                
                audioFeatureVisible = true;
            }
        }
        
        function toggleKeyboardFeatureVisibility(){
            if(keyboardFeatureVisible){
                document.getElementById("keyboard-feature-container").style.opacity = 0;
                document.getElementById("keyboard-entity-q-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-w-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-e-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-r-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-t-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-y-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-u-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-i-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-o-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-p-button-container").setAttribute("visible", false);
                
                document.getElementById("keyboard-entity-a-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-s-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-d-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-f-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-g-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-h-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-j-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-k-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-l-button-container").setAttribute("visible", false);
                
                document.getElementById("keyboard-entity-z-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-x-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-c-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-v-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-b-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-n-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-m-button-container").setAttribute("visible", false);
                
                document.getElementById("keyboard-entity-left-ctrl-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-left-opt-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-left-cmd-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-space-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-right-cmd-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-right-opt-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-left-dpad-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-up-dpad-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-down-dpad-button-container").setAttribute("visible", false);
                document.getElementById("keyboard-entity-right-dpad-button-container").setAttribute("visible", false);
                
                setTimeout(function(){
                    document.getElementById("keyboard-feature-container").style.display = "none";
                }, 500);
                
                keyboardFeatureVisible = false;
            }
            else{
                
                keyboardFeatureVisible = true;
            }
        }
        
        document.addEventListener("DOMContentLoaded", function(){
            document.getElementById("previous-mask-option-button-container").addEventListener("click", function(){
                let currentMask = maskInFocus;
                if(maskInFocus>0){
                    document.getElementById(`mask-view-${currentMask}`).setAttribute("visible", false);
                    maskInFocus--;
                    document.getElementById(`mask-view-${maskInFocus}`).setAttribute("visible", true);
                }
                else{
                    console.log("reached first item in queue");
                }
            });
            
            document.getElementById("next-mask-option-button-container").addEventListener("click", function(){
                let currentMask = maskInFocus;
                if(maskInFocus<masks.length-1){
                    document.getElementById(`mask-view-${currentMask}`).setAttribute("visible", false);
                    maskInFocus++;
                    document.getElementById(`mask-view-${maskInFocus}`).setAttribute("visible", true);
                }
                else{
                    console.log("reached last item in queue");
                }
            });
            
            document.getElementById("toggle-mask-feature-button-container").addEventListener("click", function(){
                toggleMaskFeatureVisibility();
            });
            
            document.getElementById("toggle-audio-feature-button-container").addEventListener("click", function(){
                toggleAudioFeatureVisibility();
            });
            
            setTimeout(function(){
                document.getElementById("toggle-mask-feature-button-container").click();
                document.getElementById("toggle-audio-feature-button-container").click();
            }, 4500);
        });
        
        
    </script>
</head>
<body style='margin : 0px; overflow: hidden;'>
    <audio id="audio-feature-container" style="position: absolute; bottom: 0; left: 50%; margin-left: -150px; width: 300px; z-index: 100;" controls loop>
        <source src="./media/audio/trex_low_freq_growl.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    <div id="toggle-keyboard-feature-button-container" class="toggle-feature-button-container"></div>
    <div id="toggle-mask-feature-button-container" class="toggle-feature-button-container"></div>
    <div id="toggle-audio-feature-button-container" class="toggle-feature-button-container"></div>
    <div id="mask-view-selector-container">
        <div id="previous-mask-option-button-container" class="mask-option-button-container"><</div>
        <div id="next-mask-option-button-container" class="mask-option-button-container">></div>
    </div>
    <a-scene embedded arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;">
        <a-assets timeout="30000">
            <img id="earth-planet-object-texture" src="./media/texture/earthmap1k.jpg" preload="true" />
            <img id="smile-texture" src="./media/img/smile-texture.png" preload="true" />
            <img id="frown-texture" src="./media/img/frown-texture.png" preload="true" />
            <img id="inquisitive-texture" src="./media/img/inquisitive-texture.png" preload="true" />
            <img id="exclamation-texture" src="./media/img/exclamation-texture.png" preload="true" />
            <img id="exclamation-secondary-texture" src="./media/img/exclamation-secondary-texture.png" preload="true" />
            <img id="bantu-mask-texture" src="./media/img/bantu-mask.png" preload="true" />
            <img id="rainbow-belch-texture" src="./media/img/rainbow-belch.gif" preload="true" />
        </a-assets>

        <a-marker type="pattern" url="./media/pattern/pattern-mit-logo.patt">
            <!--<a-entity
                      geometry="primitive:sphere; radius: 1.0;"
                      animation="property: rotation; to: 90 360 0; loop: true; dur: 10000; easing: linear"
                      position="0 0.5 0"
                      rotation="90 0 0"
                      material="src: #earth-planet-object-texture"></a-entity>-->
            <a-entity id="mask-view-0"
                      geometry="primitive: plane; height: 4; width: 3;"
                      position="0 0.5 -1"
                      rotation="90 180 0"
                      visible="true"
                      material="src: #smile-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-1"
                      geometry="primitive: plane; height: 4; width: 3;"
                      position="0 0.4 -1"
                      rotation="90 180 0"
                      visible="false"
                      material="src: #frown-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-2"
                      geometry="primitive: plane; height: 4; width: 3;"
                      position="0 0.3 -1"
                      rotation="90 180 0"
                      visible="false"
                      material="src: #inquisitive-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-3"
                      geometry="primitive: plane; height: 4; width: 3;"
                      position="0 0.2 -1"
                      rotation="90 180 0"
                      visible="false"
                      material="src: #exclamation-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-4"
                      geometry="primitive: plane; height: 4; width: 3;"
                      position="0 0.1 -1"
                      rotation="90 180 0"
                      visible="false"
                      material="src: #exclamation-secondary-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-5"
                      geometry="primitive: plane; height: 6; width: 3.5;"
                      position="0 0.1 -1"
                      rotation="90 180 0"
                      visible="false"
                      material="src: #bantu-mask-texture; side:double;"></a-entity>
            
            <a-entity id="mask-view-6"
                      geometry="primitive: plane; height: 1; width: 3.5;"
                      position="0 0.1 1"
                      rotation="90 90 0"
                      visible="false"
                      material="shader:gif; src: url(./media/img/rainbow-belch.gif); side:double;"></a-entity>
        </a-marker>
        
        <!--<a-marker preset="hiro">
            <a-entity
                      geometry="primitive:sphere; radius: 0.5;"
                      animation="property: rotation; to: 90 360 0; loop: true; dur: 10000; easing: linear"
                      position="0 0.5 0"
                      rotation="90 0 0"
                      material="src: #earth-planet-object-texture"></a-entity>
            <a-entity
                      geometry="primitive: plane; height: 3.5; width: 2.5;"
                      position="0 0.5 0"
                      rotation="90 0 0"
                      material="src: #smile-texture;side:double;"></a-entity>
        </a-marker>-->
        
        <a-entity camera></a-entity>
    </a-scene>
</body>
</html>
        